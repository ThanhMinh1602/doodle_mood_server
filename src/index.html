<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test WebSocket</title>
    <script src="/socket.io/socket.io.js"></script>
    <script>
        const socket = new WebSocket("ws://localhost:3000");
    
        socket.onopen = () => {
            console.log("‚úÖ WebSocket k·∫øt n·ªëi!");
            socket.send(JSON.stringify({ event: "register", data: "user_456" }));
        };
    
        socket.onmessage = (event) => {
            console.log("üì© Nh·∫≠n t·ª´ server:", event.data);
        };
    </script>
    
</head>
<body>
    <h1>WebSocket API - K·∫øt b·∫°n</h1>
    <script>
        const socket = io("http://localhost:3000");

        // User A online
        socket.emit("user_online", "userA");

        // G·ª≠i l·ªùi m·ªùi k·∫øt b·∫°n t·ª´ userA ƒë·∫øn userB
        function sendFriendRequest() {
            socket.emit("send_friend_request", { senderId: "userA", receiverId: "userB" });
        }

        // User B online
        setTimeout(() => {
            socket.emit("user_online", "userB");
        }, 3000);

        // Nh·∫≠n th√¥ng b√°o k·∫øt b·∫°n
        socket.on("receive_friend_request", (data) => {
            alert(`üì© B·∫°n nh·∫≠n ƒë∆∞·ª£c l·ªùi m·ªùi k·∫øt b·∫°n t·ª´ ${data.senderId}`);
            console.log("L·ªùi m·ªùi k·∫øt b·∫°n t·ª´:", data.senderId);
        });

        // Khi User B ch·∫•p nh·∫≠n l·ªùi m·ªùi
        function acceptFriendRequest() {
            socket.emit("accept_friend_request", { senderId: "userA", receiverId: "userB" });
        }

        // Nh·∫≠n th√¥ng b√°o l·ªùi m·ªùi ƒë√£ ƒë∆∞·ª£c ch·∫•p nh·∫≠n
        socket.on("friend_request_accepted", (data) => {
            alert(`‚úÖ ${data.receiverId} ƒë√£ ch·∫•p nh·∫≠n l·ªùi m·ªùi k·∫øt b·∫°n c·ªßa b·∫°n!`);
            console.log("L·ªùi m·ªùi ƒë∆∞·ª£c ch·∫•p nh·∫≠n b·ªüi:", data.receiverId);
        });

    </script>
    <button onclick="sendFriendRequest()">G·ª≠i k·∫øt b·∫°n</button>
    <button onclick="acceptFriendRequest()">Ch·∫•p nh·∫≠n k·∫øt b·∫°n</button>
</body>
</html>
